(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
 */const xe="https://docs.google.com/spreadsheets/d/e/2PACX-1vSekTVRYingSPdcpjSzVazPOJRJr_SxAyQV1lvqvgzvoW6BtnP8aEoVOo1sZSF6tJ27tLXv7JvxCPP9/pub?output=csv";function Re(o){const e=o.trim().replace(/\r\n/g,`
`).split(`
`);if(e.length<2)return[];const n=a=>{const c=[];let l="",g=!1;for(let y=0;y<a.length;y++){const u=a[y];u==='"'?g&&a[y+1]==='"'?(l+='"',y++):g=!g:u===","&&!g?(c.push(l),l=""):l+=u}return c.push(l),c},i=n(e[1]).map(a=>a.trim()),s=[];for(let a=2;a<e.length;a++){const c=e[a];if(!c.trim())continue;const l=n(c),g={};let y=!1;i.forEach((u,f)=>{const m=l[f]||"";g[u]=m,m.trim()!==""&&(y=!0)}),y&&s.push(g)}return s}async function oo(){const o=`${xe}&_=${Date.now()}`;try{const e=await fetch(o);if(e.ok){const n=await e.text();return Re(n)}console.warn(`Initial fetch with timestamp failed with status: ${e.status}. Retrying without timestamp.`)}catch(e){console.warn("Initial fetch with timestamp failed with a network error. Retrying without timestamp.",e)}console.log("Attempting fallback fetch without cache-busting timestamp.");try{const e=await fetch(xe);if(!e.ok)throw new Error(`Fallback fetch failed: ${e.status} ${e.statusText}`);const n=await e.text();return Re(n)}catch(e){return console.error("Error fetching or parsing stall data after fallback:",e),[]}}/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
 */const ct=[{id:"A",num:1,coords:{top:87.8,left:91,width:1.05,height:1.4},border:{top:86.15,left:52.5,bottom:89.2,right:92.05}},{id:"B",num:1,coords:{top:83.1,left:91,width:1.05,height:1.4},border:{top:81.45,left:52.5,bottom:84.5,right:92.05}},{id:"C",num:1,coords:{top:78.4,left:91,width:1.05,height:1.4},border:{top:76.75,left:52.5,bottom:79.8,right:92.05}},{id:"D",num:1,coords:{top:73.5,left:91,width:1.05,height:1.4},border:{top:71.85,left:52.5,bottom:74.9,right:92.05}},{id:"E",num:1,coords:{top:68.5,left:91,width:1.05,height:1.4},border:{top:66.85,left:52.5,bottom:69.9,right:92.05}},{id:"F",num:1,coords:{top:63.9,left:91,width:1.05,height:1.4},border:{top:62.25,left:52.5,bottom:65.3,right:92.05}},{id:"G",num:1,coords:{top:59.1,left:91,width:1.05,height:1.4},border:{top:57.45,left:52.5,bottom:60.5,right:92.05}},{id:"H",num:1,coords:{top:54.3,left:91,width:1.05,height:1.4},border:{top:52.65,left:52.5,bottom:55.7,right:92.05}},{id:"I",num:1,coords:{top:49.5,left:91,width:1.05,height:1.4},border:{top:47.85,left:52.5,bottom:50.9,right:92.05}},{id:"J",num:1,coords:{top:44.5,left:91,width:1.05,height:1.4},border:{top:42.85,left:52.5,bottom:45.9,right:92.05}},{id:"K",num:1,coords:{top:39.6,left:91,width:1.05,height:1.4},border:{top:37.95,left:52.5,bottom:41,right:92.05}},{id:"L",num:1,coords:{top:34.8,left:91,width:1.05,height:1.4},border:{top:33.15,left:52.5,bottom:36.2,right:92.05}},{id:"M",num:1,coords:{top:30.1,left:91,width:1.05,height:1.4},border:{top:28.45,left:52.5,bottom:31.5,right:92.05}},{id:"N",num:1,coords:{top:25.2,left:91,width:1.05,height:1.4},border:{top:23.55,left:52.5,bottom:26.6,right:92.05}},{id:"O",num:1,coords:{top:20.4,left:91,width:1.05,height:1.4},border:{top:18.75,left:52.5,bottom:21.8,right:92.05}},{id:"P",num:1,coords:{top:15.6,left:91,width:1.05,height:1.4},border:{top:13.95,left:52.5,bottom:17,right:92.05}},{id:"Q",num:1,coords:{top:10.8,left:91,width:1.05,height:1.4},border:{top:9.15,left:52.5,bottom:12.2,right:92.05}},{id:"R",num:1,coords:{top:87.8,left:46.3,width:1.05,height:1.4},border:{top:86.15,left:7.8,bottom:89.2,right:47.35}},{id:"S",num:1,coords:{top:83.1,left:46.3,width:1.05,height:1.4},border:{top:81.45,left:7.8,bottom:84.5,right:47.35}},{id:"T",num:1,coords:{top:78.4,left:46.3,width:1.05,height:1.4},border:{top:76.75,left:7.8,bottom:79.8,right:47.35}},{id:"U",num:1,coords:{top:73.5,left:46.3,width:1.05,height:1.4},border:{top:71.85,left:7.8,bottom:74.9,right:47.35}},{id:"V",num:1,coords:{top:68.7,left:46.3,width:1.05,height:1.4},border:{top:67.05,left:7.8,bottom:70.1,right:47.35}},{id:"W",num:1,coords:{top:63.9,left:46.3,width:1.05,height:1.4},border:{top:62.25,left:7.8,bottom:65.3,right:47.35}},{id:"X",num:1,coords:{top:59.1,left:46.3,width:1.05,height:1.4},border:{top:57.45,left:7.8,bottom:60.5,right:47.35}},{id:"Y",num:1,coords:{top:54.3,left:46.3,width:1.05,height:1.4},border:{top:52.65,left:7.8,bottom:55.7,right:47.35}},{id:"Z",num:1,coords:{top:49.5,left:46.3,width:1.05,height:1.4},border:{top:47.85,left:7.8,bottom:50.9,right:47.35}},{id:"鼠",num:1,coords:{top:44.5,left:46.3,width:1.05,height:1.4},border:{top:42.85,left:7.8,bottom:45.9,right:47.35}},{id:"牛",num:1,coords:{top:39.6,left:46.3,width:1.05,height:1.4},border:{top:37.95,left:7.8,bottom:41,right:47.35}},{id:"虎",num:1,coords:{top:34.9,left:46.3,width:1.05,height:1.4},border:{top:33.25,left:7.8,bottom:36.3,right:47.35}},{id:"兔",num:1,coords:{top:30.1,left:46.3,width:1.05,height:1.4},border:{top:28.45,left:7.8,bottom:31.5,right:47.35}},{id:"龍",num:1,coords:{top:25.2,left:46.3,width:1.05,height:1.4},border:{top:23.55,left:7.8,bottom:26.6,right:47.35}},{id:"蛇",num:1,coords:{top:20.4,left:46.3,width:1.05,height:1.4},border:{top:18.75,left:7.8,bottom:21.8,right:47.35}},{id:"馬",num:1,coords:{top:15.6,left:46.3,width:1.05,height:1.4},border:{top:13.95,left:7.8,bottom:17,right:47.35}},{id:"羊",num:1,coords:{top:10.8,left:46.3,width:1.05,height:1.4},border:{top:9.15,left:7.8,bottom:12.2,right:47.35}},{id:"猴",num:1,coords:{top:73.5,left:4.5,width:1.1,height:1.44},border:{top:52.7,left:4.5,bottom:74.9,right:5.55},isGrouped:!0},{id:"雞",num:1,coords:{top:43.7,left:4.5,width:1.1,height:1.44},border:{top:23,left:4.5,bottom:45.6,right:5.55},isGrouped:!0},{id:"狗",num:1,coords:{top:18.2,left:4.5,width:1.1,height:1.44},border:{top:7.5,left:4.5,bottom:19.8,right:5.55},isGrouped:!0},{id:"特",num:1,coords:{top:84.4,left:4.15,width:1.8,height:2.41},border:{top:77.15,left:4.15,bottom:87.2,right:5.75},isGrouped:!0},{id:"商",num:1,coords:{top:89.5,left:4.15,width:1.8,height:2.41},border:{top:87.5,left:4.15,bottom:91.5,right:5.75},isGrouped:!0},{id:"範",num:1,coords:{top:.5,left:91,width:5,height:5},border:{top:.5,left:86,bottom:5.5,right:96}}];/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
 */const no=new Map(ct.map(o=>[o.id,o]));function io(o,e){return e?e.split(";").map((n,i)=>{const s=`${o}-宣傳車${i+1}`,a=n.trim();return{text:s,href:a}}).filter(n=>n!==null&&!!n.text&&!!n.href):[]}function ao(o){return o?o.split(";").map(e=>e.trim()).filter(e=>e):[]}function so(o){const e=new Map;return o.forEach(n=>{const i=n.id||n.stallId;if(!i)return;let s=e.get(i);if(!s){const c=i.substring(0,1),l=parseInt(n.num,10),g=parseInt(n.stallCnt,10)||1,y=no.get(c);if(!y||isNaN(l)){console.warn(`Could not calculate position for stall ID: ${i}. Skipping base creation.`);return}const u=y.coords;let f,m;if(c!=="狗"&&c!=="雞"&&c!=="猴"&&c!=="特"&&c!=="商"){const p=l>36?72-l:l;let E=0,w=u.top,L=u.left;l>24&&l<=48?E=1.75:l<=12||l>=61?E=0:E=.9,l>36?(w=w-u.height-.25,L=u.left-p%72*u.width-E):(L=u.left-(p-1)*u.width-E,g>1&&(L-=(g-1)*u.width));const I=parseFloat(L.toFixed(2)),N=u.width*g;f={top:`${w}%`,left:`${I}%`,width:`${N}%`,height:`${u.height}%`},m={top:w,left:I,width:N,height:u.height}}else{let p=l,E=0;c==="狗"?l>=4&&l<16?(p=3,E=.8):l>=16&&(p=l-12,E=.4):c==="雞"?l>=4&&l<21?(p=3,E=.8):l>=21&&(p=l-17,E=.4):c==="猴"&&(l>=4&&l<23?(p=3,E=.8):l>=23&&(p=l-19,E=.5));let w=u.top-u.height*(p-1)-E;g>1&&(w-=(g-1)*u.height);const L=parseFloat(w.toFixed(2)),I=u.height*g;f={top:`${L}%`,left:`${u.left}%`,width:`${u.width}%`,height:`${I}%`},m={top:L,left:u.left,width:u.width,height:I}}let r=n.stallImg||void 0;r&&r.startsWith("assets/2025/")&&(r=`https://cdn.jsdelivr.net/gh/v4724/nice-0816@d24cd07/${r}`),s={id:i,num:l,stallCnt:g,coords:f,numericCoords:m,stallTitle:n.stallTitle||"N/A",stallImg:r,stallLink:n.stallLink||void 0,promoData:[],promoTags:[]},e.set(i,s)}const a=n.promoUser||"";if(a){const c={stallId:i,promoUser:a,promoAvatar:n.promoAvatar||"",promoHTML:n.promoHTML||"",promoLinks:io(a,n.promoLinks),promoTags:ao(n.promoTags)};s.promoData.push(c)}}),e.forEach(n=>{const i=new Set;n.promoData.forEach(s=>{s.promoTags.forEach(a=>i.add(a))}),n.promoTags=Array.from(i)}),Array.from(e.values())}/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
 */const ot=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","鼠","牛","虎","兔","龍","蛇","馬","羊","商","特","猴","雞","狗"],ro=(o,e)=>{const n=e.toLowerCase().trim();return n===""?o:o.filter(i=>{const s=i.promoData.some(a=>a.promoUser.toLowerCase().includes(n));return i.id.toLowerCase().includes(n)||i.stallTitle.toLowerCase().includes(n)||s})},It=(o,e,n)=>{const i=o.id.substring(0,1),s=o.num,a=["狗","雞","猴","特","商"].includes(i),c=ot.indexOf(i);if(n==="right"&&i>="A"&&i<="Q"&&(s===1||s===72))return null;if(n==="left"||n==="right"){const l=n==="right"?"prev":"next",g=!a&&!(s>=1&&s<=36),y=l==="next"?1:-1,u=g?-y:y;let f=s+u;for(;f>=1&&f<=72;){const m=e.find(r=>r.id.startsWith(i)&&r.num===f);if(m)return m.id;f+=u}return null}if(n==="up"||n==="down"){if(c===-1)return null;const l=n==="up"?1:-1;let g=c+l;for(;g>=0&&g<ot.length;){const y=ot[g],u=e.filter(f=>f.id.startsWith(y));if(u.length>0){let f;return a?n==="down"?f=u.sort((m,r)=>r.num-m.num)[0]:f=u.sort((m,r)=>m.num-r.num)[0]:(f=u.find(m=>m.num===s),f||(f=u.sort((m,r)=>Math.abs(m.num-s)-Math.abs(r.num-s))[0])),(f==null?void 0:f.id)||null}g+=l}}return null};/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
 */function lo(o,e,n,i,s,a,c,l,g){const y=g?3.5:2.5,u=new Map,f=new Map;let m=!1,r=!1,p=!1,E=0,w=0,L=0,I=0,N=!1,v=null;const T=()=>{const x=o.offsetWidth,R=o.offsetHeight;if(x===0||R===0)return;const U=(n.offsetLeft+n.offsetWidth/2)/x*100,$=(n.offsetTop+n.offsetHeight/2)/R*100;if($<9.15||$>89.2){a.current.textContent="",a.prev.textContent="",a.next.textContent="";return}let H=null,mt=1/0;for(const P of ct){const ft=Math.max(P.border.left-U,0,U-P.border.right),k=Math.max(P.border.top-$,0,$-P.border.bottom),nt=ft*ft+k*k;nt<mt&&(mt=nt,H=P)}if(H){const P=ot.indexOf(H.id);a.current.textContent=H.id,a.prev.textContent=P>0?ot[P-1]:"",a.next.textContent=P<ot.length-1?ot[P+1]:""}else a.current.textContent="",a.prev.textContent="",a.next.textContent=""},S=()=>{const x=n.offsetWidth,R=n.offsetHeight,U=n.offsetLeft+x/2,$=n.offsetTop+R/2,Y=-(U*y-x/2),Q=-($*y-R/2);i.style.backgroundPosition=`${Y}px ${Q}px`,s.style.left=`${Y}px`,s.style.top=`${Q}px`,T()},M=(x,R)=>{const U=n.offsetWidth,$=n.offsetHeight,Y=o.offsetWidth,Q=o.offsetHeight,H=-U/2,mt=-$/2,P=Y-U/2,ft=Q-$/2,k=Math.max(H,Math.min(x,P)),nt=Math.max(mt,Math.min(R,ft));n.style.left=`${k}px`,n.style.top=`${nt}px`;const ut=a.current.parentElement;if(ut){const _t=ut.offsetWidth;let pt=0;k<0?pt=-k:k+_t>Y&&(pt=Y-(k+_t)),ut.style.transform=`translateX(${pt}px) translateY(-50%)`}S()},C=x=>{var Y;x.preventDefault(),m=!0,N=!1,v=x.target;const R=(Y=x.touches)==null?void 0:Y[0],U=R?R.clientX:x.clientX,$=R?R.clientY:x.clientY;E=U,w=$,L=n.offsetLeft,I=n.offsetTop,document.addEventListener("mousemove",D),document.addEventListener("touchmove",D,{passive:!1}),document.addEventListener("mouseup",O),document.addEventListener("touchend",O)},D=x=>{var H;if(!m)return;const R=(H=x.touches)==null?void 0:H[0],U=R?R.clientX:x.clientX,$=R?R.clientY:x.clientY,Y=U-E,Q=$-w;!N&&(Math.abs(Y)>5||Math.abs(Q)>5)&&(N=!0),M(L+Y,I+Q)},O=()=>{m&&(m=!1,document.removeEventListener("mousemove",D),document.removeEventListener("touchmove",D),document.removeEventListener("mouseup",O),document.removeEventListener("touchend",O),!N&&v&&v.closest(".stall-area")&&l(v),v=null)},B=()=>{if(r=!0,i.style.backgroundSize=`${e.offsetWidth*y}px ${e.offsetHeight*y}px`,i.style.backgroundImage=`url('${e.src}')`,s.style.width=`${e.offsetWidth}px`,s.style.height=`${e.offsetHeight}px`,s.style.transform=`scale(${y})`,n.style.display="block",!p){const x=o.offsetWidth,R=o.offsetHeight,U=n.offsetWidth,$=n.offsetHeight;M((x-U)/2,(R-$)/2),p=!0}c.setAttribute("aria-pressed","true"),c.textContent="隱藏放大鏡",S()},K=()=>{r=!1,n.style.display="none",c.setAttribute("aria-pressed","false"),c.textContent="顯示放大鏡"},Z=()=>{r?K():B()};return c.addEventListener("click",Z),n.addEventListener("mousedown",C),n.addEventListener("touchstart",C,{passive:!1}),{addStall:x=>{const R=x.dataset.stallId;if(!R)return;const U=x.cloneNode(!0);s.appendChild(U),u.set(R,x),f.set(R,U)},addGroupArea:x=>{const R=x.cloneNode(!0);s.appendChild(R)},updateStallClass:(x,R,U)=>{const $=u.get(x);$&&$.classList.toggle(R,U);const Y=f.get(x);Y&&Y.classList.toggle(R,U)},show:B,hide:K,toggle:Z,isShown:()=>r}}/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
 */const co=["map-container","map-image","magnifier-wrapper","magnifier","magnifier-stall-layer","tooltip","modal","modal-close","modal-overlay","modal-title","modal-body","modal-footer","instructions-text","search-input","toggle-magnifier-btn","modal-magnifier-wrapper","modal-magnifier","modal-magnifier-stall-layer","modal-nav-controls","modal-nav-up","modal-nav-down","modal-nav-left","modal-nav-right","magnifier-row-indicator-container","magnifier-row-indicator-prev","magnifier-row-indicator-current","magnifier-row-indicator-next","modal-magnifier-row-indicator-container","modal-magnifier-row-indicator-prev","modal-magnifier-row-indicator-current","modal-magnifier-row-indicator-next","modal-vertical-stall-list","image-lightbox","image-lightbox-close","image-lightbox-image"];function mo(){const o={mapContainer:document.getElementById("map-container"),mapImage:document.getElementById("map-image"),magnifierWrapper:document.getElementById("magnifier-wrapper"),magnifier:document.getElementById("magnifier"),magnifierStallLayer:document.getElementById("magnifier-stall-layer"),magnifierRowIndicatorContainer:document.getElementById("magnifier-row-indicator-container"),magnifierRowIndicatorPrev:document.getElementById("magnifier-row-indicator-prev"),magnifierRowIndicatorCurrent:document.getElementById("magnifier-row-indicator-current"),magnifierRowIndicatorNext:document.getElementById("magnifier-row-indicator-next"),tooltip:document.getElementById("tooltip"),modal:document.getElementById("modal"),modalClose:document.getElementById("modal-close"),modalOverlay:document.getElementById("modal-overlay"),modalHeader:document.querySelector(".modal-header"),modalTitle:document.getElementById("modal-title"),modalBody:document.getElementById("modal-body"),modalFooter:document.getElementById("modal-footer"),instructionsEl:document.getElementById("instructions-text"),searchInput:document.getElementById("search-input"),toggleMagnifierBtn:document.getElementById("toggle-magnifier-btn"),modalMagnifierWrapper:document.getElementById("modal-magnifier-wrapper"),modalMagnifier:document.getElementById("modal-magnifier"),modalMagnifierStallLayer:document.getElementById("modal-magnifier-stall-layer"),modalMagnifierRowIndicatorContainer:document.getElementById("modal-magnifier-row-indicator-container"),modalMagnifierRowIndicatorPrev:document.getElementById("modal-magnifier-row-indicator-prev"),modalMagnifierRowIndicatorCurrent:document.getElementById("modal-magnifier-row-indicator-current"),modalMagnifierRowIndicatorNext:document.getElementById("modal-magnifier-row-indicator-next"),modalNavControls:document.getElementById("modal-nav-controls"),modalNavUp:document.getElementById("modal-nav-up"),modalNavDown:document.getElementById("modal-nav-down"),modalNavLeft:document.getElementById("modal-nav-left"),modalNavRight:document.getElementById("modal-nav-right"),modalVerticalStallList:document.getElementById("modal-vertical-stall-list"),imageLightbox:document.getElementById("image-lightbox"),imageLightboxClose:document.getElementById("image-lightbox-close"),imageLightboxImage:document.getElementById("image-lightbox-image")};for(const e in o)if(!o[e])throw new Error(`Essential DOM element not found: #${e}. The application cannot start.`);return o}/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
 */const Ct={selectedStallElement:null,stallIdToModalCloneMap:new Map,rowIdToModalGroupCloneMap:new Map};function fo(o,e,n,i){const s=new Set(ct.filter(a=>a.isGrouped).map(a=>a.id));o.forEach(a=>{if(!a.coords)return;const c=document.createElement("div");c.className="stall-area",a.promoData.length>0&&c.classList.add("has-promo");const l=a.id.substring(0,1);s.has(l)&&c.classList.add("is-grouped-member"),c.dataset.stallId=a.id,c.style.top=a.coords.top,c.style.left=a.coords.left,c.style.width=a.coords.width,c.style.height=a.coords.height,c.setAttribute("aria-label",`Stall: ${a.stallTitle}`),a.num&&(c.textContent=a.num.toString().padStart(2,"0")),e.mapContainer.appendChild(c),n==null||n.addStall(c);const g=c.cloneNode(!0);e.modalMagnifierStallLayer.appendChild(g),i.stallIdToModalCloneMap.set(a.id,g)}),ct.forEach(a=>{const c=document.createElement("div");if(c.className="stall-area stall-group-area",c.dataset.rowId=a.id,c.style.top=`${a.border.top}%`,c.style.left=`${a.border.left}%`,c.style.width=`${a.border.right-a.border.left}%`,c.style.height=`${a.border.bottom-a.border.top}%`,c.setAttribute("aria-label",`Row: ${a.id}`),c.textContent=a.id,a.isGrouped||c.classList.add("mobile-only-group"),e.mapContainer.appendChild(c),a.isGrouped){n==null||n.addGroupArea(c);const l=c.cloneNode(!0);e.modalMagnifierStallLayer.appendChild(l),i.rowIdToModalGroupCloneMap.set(a.id,l)}})}function ce(o,e,n,i,s){const a=o.dataset.stallId;if(!a)return;i?i.updateStallClass(a,e,n):o.classList.toggle(e,n);const c=s.stallIdToModalCloneMap.get(a);c&&c.classList.toggle(e,n)}function $e(o,e,n){n.selectedStallElement&&ce(n.selectedStallElement,"is-selected",!1,e,n),n.selectedStallElement=null,o.tooltip.classList.add("hidden")}/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:Ye,setPrototypeOf:Ne,isFrozen:uo,getPrototypeOf:po,getOwnPropertyDescriptor:ho}=Object;let{freeze:q,seal:tt,create:ze}=Object,{apply:re,construct:le}=typeof Reflect<"u"&&Reflect;q||(q=function(e){return e});tt||(tt=function(e){return e});re||(re=function(e,n,i){return e.apply(n,i)});le||(le=function(e,n){return new e(...n)});const Yt=j(Array.prototype.forEach),go=j(Array.prototype.lastIndexOf),De=j(Array.prototype.pop),xt=j(Array.prototype.push),Eo=j(Array.prototype.splice),Gt=j(String.prototype.toLowerCase),ee=j(String.prototype.toString),Oe=j(String.prototype.match),Rt=j(String.prototype.replace),bo=j(String.prototype.indexOf),To=j(String.prototype.trim),et=j(Object.prototype.hasOwnProperty),V=j(RegExp.prototype.test),Nt=yo(TypeError);function j(o){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return re(o,e,i)}}function yo(o){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return le(o,n)}}function _(o,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Gt;Ne&&Ne(o,null);let i=e.length;for(;i--;){let s=e[i];if(typeof s=="string"){const a=n(s);a!==s&&(uo(e)||(e[i]=a),s=a)}o[s]=!0}return o}function wo(o){for(let e=0;e<o.length;e++)et(o,e)||(o[e]=null);return o}function lt(o){const e=ze(null);for(const[n,i]of Ye(o))et(o,n)&&(Array.isArray(i)?e[n]=wo(i):i&&typeof i=="object"&&i.constructor===Object?e[n]=lt(i):e[n]=i);return e}function Dt(o,e){for(;o!==null;){const i=ho(o,e);if(i){if(i.get)return j(i.get);if(typeof i.value=="function")return j(i.value)}o=po(o)}function n(){return null}return n}const Pe=q(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),oe=q(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ne=q(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Lo=q(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ie=q(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Io=q(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ke=q(["#text"]),Be=q(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ae=q(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),He=q(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),zt=q(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),vo=tt(/\{\{[\w\W]*|[\w\W]*\}\}/gm),_o=tt(/<%[\w\W]*|[\w\W]*%>/gm),Ao=tt(/\$\{[\w\W]*/gm),So=tt(/^data-[\-\w.\u00B7-\uFFFF]+$/),Mo=tt(/^aria-[\-\w]+$/),We=tt(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Co=tt(/^(?:\w+script|data):/i),xo=tt(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ge=tt(/^html$/i),Ro=tt(/^[a-z][.\w]*(-[.\w]+)+$/i);var Ue=Object.freeze({__proto__:null,ARIA_ATTR:Mo,ATTR_WHITESPACE:xo,CUSTOM_ELEMENT:Ro,DATA_ATTR:So,DOCTYPE_NAME:Ge,ERB_EXPR:_o,IS_ALLOWED_URI:We,IS_SCRIPT_OR_DATA:Co,MUSTACHE_EXPR:vo,TMPLIT_EXPR:Ao});const Ot={element:1,text:3,progressingInstruction:7,comment:8,document:9},No=function(){return typeof window>"u"?null:window},Do=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const s="data-tt-policy-suffix";n&&n.hasAttribute(s)&&(i=n.getAttribute(s));const a="dompurify"+(i?"#"+i:"");try{return e.createPolicy(a,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}},Fe=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Xe(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:No();const e=b=>Xe(b);if(e.version="3.2.6",e.removed=[],!o||!o.document||o.document.nodeType!==Ot.document||!o.Element)return e.isSupported=!1,e;let{document:n}=o;const i=n,s=i.currentScript,{DocumentFragment:a,HTMLTemplateElement:c,Node:l,Element:g,NodeFilter:y,NamedNodeMap:u=o.NamedNodeMap||o.MozNamedAttrMap,HTMLFormElement:f,DOMParser:m,trustedTypes:r}=o,p=g.prototype,E=Dt(p,"cloneNode"),w=Dt(p,"remove"),L=Dt(p,"nextSibling"),I=Dt(p,"childNodes"),N=Dt(p,"parentNode");if(typeof c=="function"){const b=n.createElement("template");b.content&&b.content.ownerDocument&&(n=b.content.ownerDocument)}let v,T="";const{implementation:S,createNodeIterator:M,createDocumentFragment:C,getElementsByTagName:D}=n,{importNode:O}=i;let B=Fe();e.isSupported=typeof Ye=="function"&&typeof N=="function"&&S&&S.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:K,ERB_EXPR:Z,TMPLIT_EXPR:dt,DATA_ATTR:x,ARIA_ATTR:R,IS_SCRIPT_OR_DATA:U,ATTR_WHITESPACE:$,CUSTOM_ELEMENT:Y}=Ue;let{IS_ALLOWED_URI:Q}=Ue,H=null;const mt=_({},[...Pe,...oe,...ne,...ie,...ke]);let P=null;const ft=_({},[...Be,...ae,...He,...zt]);let k=Object.seal(ze(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),nt=null,ut=null,_t=!0,pt=!0,de=!1,me=!0,gt=!1,Pt=!0,ht=!1,Xt=!1,Vt=!1,Et=!1,kt=!1,Bt=!1,fe=!0,ue=!1;const qe="user-content-";let qt=!0,At=!1,bt={},Tt=null;const pe=_({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let he=null;const ge=_({},["audio","video","img","source","image","track"]);let jt=null;const Ee=_({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ht="http://www.w3.org/1998/Math/MathML",Ut="http://www.w3.org/2000/svg",at="http://www.w3.org/1999/xhtml";let yt=at,Kt=!1,Zt=null;const je=_({},[Ht,Ut,at],ee);let Ft=_({},["mi","mo","mn","ms","mtext"]),$t=_({},["annotation-xml"]);const Ke=_({},["title","style","font","a","script"]);let St=null;const Ze=["application/xhtml+xml","text/html"],Je="text/html";let W=null,wt=null;const Qe=n.createElement("form"),be=function(t){return t instanceof RegExp||t instanceof Function},Jt=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(wt&&wt===t)){if((!t||typeof t!="object")&&(t={}),t=lt(t),St=Ze.indexOf(t.PARSER_MEDIA_TYPE)===-1?Je:t.PARSER_MEDIA_TYPE,W=St==="application/xhtml+xml"?ee:Gt,H=et(t,"ALLOWED_TAGS")?_({},t.ALLOWED_TAGS,W):mt,P=et(t,"ALLOWED_ATTR")?_({},t.ALLOWED_ATTR,W):ft,Zt=et(t,"ALLOWED_NAMESPACES")?_({},t.ALLOWED_NAMESPACES,ee):je,jt=et(t,"ADD_URI_SAFE_ATTR")?_(lt(Ee),t.ADD_URI_SAFE_ATTR,W):Ee,he=et(t,"ADD_DATA_URI_TAGS")?_(lt(ge),t.ADD_DATA_URI_TAGS,W):ge,Tt=et(t,"FORBID_CONTENTS")?_({},t.FORBID_CONTENTS,W):pe,nt=et(t,"FORBID_TAGS")?_({},t.FORBID_TAGS,W):lt({}),ut=et(t,"FORBID_ATTR")?_({},t.FORBID_ATTR,W):lt({}),bt=et(t,"USE_PROFILES")?t.USE_PROFILES:!1,_t=t.ALLOW_ARIA_ATTR!==!1,pt=t.ALLOW_DATA_ATTR!==!1,de=t.ALLOW_UNKNOWN_PROTOCOLS||!1,me=t.ALLOW_SELF_CLOSE_IN_ATTR!==!1,gt=t.SAFE_FOR_TEMPLATES||!1,Pt=t.SAFE_FOR_XML!==!1,ht=t.WHOLE_DOCUMENT||!1,Et=t.RETURN_DOM||!1,kt=t.RETURN_DOM_FRAGMENT||!1,Bt=t.RETURN_TRUSTED_TYPE||!1,Vt=t.FORCE_BODY||!1,fe=t.SANITIZE_DOM!==!1,ue=t.SANITIZE_NAMED_PROPS||!1,qt=t.KEEP_CONTENT!==!1,At=t.IN_PLACE||!1,Q=t.ALLOWED_URI_REGEXP||We,yt=t.NAMESPACE||at,Ft=t.MATHML_TEXT_INTEGRATION_POINTS||Ft,$t=t.HTML_INTEGRATION_POINTS||$t,k=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&be(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(k.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&be(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(k.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(k.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),gt&&(pt=!1),kt&&(Et=!0),bt&&(H=_({},ke),P=[],bt.html===!0&&(_(H,Pe),_(P,Be)),bt.svg===!0&&(_(H,oe),_(P,ae),_(P,zt)),bt.svgFilters===!0&&(_(H,ne),_(P,ae),_(P,zt)),bt.mathMl===!0&&(_(H,ie),_(P,He),_(P,zt))),t.ADD_TAGS&&(H===mt&&(H=lt(H)),_(H,t.ADD_TAGS,W)),t.ADD_ATTR&&(P===ft&&(P=lt(P)),_(P,t.ADD_ATTR,W)),t.ADD_URI_SAFE_ATTR&&_(jt,t.ADD_URI_SAFE_ATTR,W),t.FORBID_CONTENTS&&(Tt===pe&&(Tt=lt(Tt)),_(Tt,t.FORBID_CONTENTS,W)),qt&&(H["#text"]=!0),ht&&_(H,["html","head","body"]),H.table&&(_(H,["tbody"]),delete nt.tbody),t.TRUSTED_TYPES_POLICY){if(typeof t.TRUSTED_TYPES_POLICY.createHTML!="function")throw Nt('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof t.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Nt('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');v=t.TRUSTED_TYPES_POLICY,T=v.createHTML("")}else v===void 0&&(v=Do(r,s)),v!==null&&typeof T=="string"&&(T=v.createHTML(""));q&&q(t),wt=t}},Te=_({},[...oe,...ne,...Lo]),ye=_({},[...ie,...Io]),to=function(t){let d=N(t);(!d||!d.tagName)&&(d={namespaceURI:yt,tagName:"template"});const h=Gt(t.tagName),F=Gt(d.tagName);return Zt[t.namespaceURI]?t.namespaceURI===Ut?d.namespaceURI===at?h==="svg":d.namespaceURI===Ht?h==="svg"&&(F==="annotation-xml"||Ft[F]):!!Te[h]:t.namespaceURI===Ht?d.namespaceURI===at?h==="math":d.namespaceURI===Ut?h==="math"&&$t[F]:!!ye[h]:t.namespaceURI===at?d.namespaceURI===Ut&&!$t[F]||d.namespaceURI===Ht&&!Ft[F]?!1:!ye[h]&&(Ke[h]||!Te[h]):!!(St==="application/xhtml+xml"&&Zt[t.namespaceURI]):!1},it=function(t){xt(e.removed,{element:t});try{N(t).removeChild(t)}catch{w(t)}},Lt=function(t,d){try{xt(e.removed,{attribute:d.getAttributeNode(t),from:d})}catch{xt(e.removed,{attribute:null,from:d})}if(d.removeAttribute(t),t==="is")if(Et||kt)try{it(d)}catch{}else try{d.setAttribute(t,"")}catch{}},we=function(t){let d=null,h=null;if(Vt)t="<remove></remove>"+t;else{const z=Oe(t,/^[\r\n\t ]+/);h=z&&z[0]}St==="application/xhtml+xml"&&yt===at&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");const F=v?v.createHTML(t):t;if(yt===at)try{d=new m().parseFromString(F,St)}catch{}if(!d||!d.documentElement){d=S.createDocument(yt,"template",null);try{d.documentElement.innerHTML=Kt?T:F}catch{}}const G=d.body||d.documentElement;return t&&h&&G.insertBefore(n.createTextNode(h),G.childNodes[0]||null),yt===at?D.call(d,ht?"html":"body")[0]:ht?d.documentElement:G},Le=function(t){return M.call(t.ownerDocument||t,t,y.SHOW_ELEMENT|y.SHOW_COMMENT|y.SHOW_TEXT|y.SHOW_PROCESSING_INSTRUCTION|y.SHOW_CDATA_SECTION,null)},Qt=function(t){return t instanceof f&&(typeof t.nodeName!="string"||typeof t.textContent!="string"||typeof t.removeChild!="function"||!(t.attributes instanceof u)||typeof t.removeAttribute!="function"||typeof t.setAttribute!="function"||typeof t.namespaceURI!="string"||typeof t.insertBefore!="function"||typeof t.hasChildNodes!="function")},Ie=function(t){return typeof l=="function"&&t instanceof l};function st(b,t,d){Yt(b,h=>{h.call(e,t,d,wt)})}const ve=function(t){let d=null;if(st(B.beforeSanitizeElements,t,null),Qt(t))return it(t),!0;const h=W(t.nodeName);if(st(B.uponSanitizeElement,t,{tagName:h,allowedTags:H}),Pt&&t.hasChildNodes()&&!Ie(t.firstElementChild)&&V(/<[/\w!]/g,t.innerHTML)&&V(/<[/\w!]/g,t.textContent)||t.nodeType===Ot.progressingInstruction||Pt&&t.nodeType===Ot.comment&&V(/<[/\w]/g,t.data))return it(t),!0;if(!H[h]||nt[h]){if(!nt[h]&&Ae(h)&&(k.tagNameCheck instanceof RegExp&&V(k.tagNameCheck,h)||k.tagNameCheck instanceof Function&&k.tagNameCheck(h)))return!1;if(qt&&!Tt[h]){const F=N(t)||t.parentNode,G=I(t)||t.childNodes;if(G&&F){const z=G.length;for(let J=z-1;J>=0;--J){const rt=E(G[J],!0);rt.__removalCount=(t.__removalCount||0)+1,F.insertBefore(rt,L(t))}}}return it(t),!0}return t instanceof g&&!to(t)||(h==="noscript"||h==="noembed"||h==="noframes")&&V(/<\/no(script|embed|frames)/i,t.innerHTML)?(it(t),!0):(gt&&t.nodeType===Ot.text&&(d=t.textContent,Yt([K,Z,dt],F=>{d=Rt(d,F," ")}),t.textContent!==d&&(xt(e.removed,{element:t.cloneNode()}),t.textContent=d)),st(B.afterSanitizeElements,t,null),!1)},_e=function(t,d,h){if(fe&&(d==="id"||d==="name")&&(h in n||h in Qe))return!1;if(!(pt&&!ut[d]&&V(x,d))){if(!(_t&&V(R,d))){if(!P[d]||ut[d]){if(!(Ae(t)&&(k.tagNameCheck instanceof RegExp&&V(k.tagNameCheck,t)||k.tagNameCheck instanceof Function&&k.tagNameCheck(t))&&(k.attributeNameCheck instanceof RegExp&&V(k.attributeNameCheck,d)||k.attributeNameCheck instanceof Function&&k.attributeNameCheck(d))||d==="is"&&k.allowCustomizedBuiltInElements&&(k.tagNameCheck instanceof RegExp&&V(k.tagNameCheck,h)||k.tagNameCheck instanceof Function&&k.tagNameCheck(h))))return!1}else if(!jt[d]){if(!V(Q,Rt(h,$,""))){if(!((d==="src"||d==="xlink:href"||d==="href")&&t!=="script"&&bo(h,"data:")===0&&he[t])){if(!(de&&!V(U,Rt(h,$,"")))){if(h)return!1}}}}}}return!0},Ae=function(t){return t!=="annotation-xml"&&Oe(t,Y)},Se=function(t){st(B.beforeSanitizeAttributes,t,null);const{attributes:d}=t;if(!d||Qt(t))return;const h={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:P,forceKeepAttr:void 0};let F=d.length;for(;F--;){const G=d[F],{name:z,namespaceURI:J,value:rt}=G,Mt=W(z),te=rt;let X=z==="value"?te:To(te);if(h.attrName=Mt,h.attrValue=X,h.keepAttr=!0,h.forceKeepAttr=void 0,st(B.uponSanitizeAttribute,t,h),X=h.attrValue,ue&&(Mt==="id"||Mt==="name")&&(Lt(z,t),X=qe+X),Pt&&V(/((--!?|])>)|<\/(style|title)/i,X)){Lt(z,t);continue}if(h.forceKeepAttr)continue;if(!h.keepAttr){Lt(z,t);continue}if(!me&&V(/\/>/i,X)){Lt(z,t);continue}gt&&Yt([K,Z,dt],Ce=>{X=Rt(X,Ce," ")});const Me=W(t.nodeName);if(!_e(Me,Mt,X)){Lt(z,t);continue}if(v&&typeof r=="object"&&typeof r.getAttributeType=="function"&&!J)switch(r.getAttributeType(Me,Mt)){case"TrustedHTML":{X=v.createHTML(X);break}case"TrustedScriptURL":{X=v.createScriptURL(X);break}}if(X!==te)try{J?t.setAttributeNS(J,z,X):t.setAttribute(z,X),Qt(t)?it(t):De(e.removed)}catch{Lt(z,t)}}st(B.afterSanitizeAttributes,t,null)},eo=function b(t){let d=null;const h=Le(t);for(st(B.beforeSanitizeShadowDOM,t,null);d=h.nextNode();)st(B.uponSanitizeShadowNode,d,null),ve(d),Se(d),d.content instanceof a&&b(d.content);st(B.afterSanitizeShadowDOM,t,null)};return e.sanitize=function(b){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=null,h=null,F=null,G=null;if(Kt=!b,Kt&&(b="<!-->"),typeof b!="string"&&!Ie(b))if(typeof b.toString=="function"){if(b=b.toString(),typeof b!="string")throw Nt("dirty is not a string, aborting")}else throw Nt("toString is not a function");if(!e.isSupported)return b;if(Xt||Jt(t),e.removed=[],typeof b=="string"&&(At=!1),At){if(b.nodeName){const rt=W(b.nodeName);if(!H[rt]||nt[rt])throw Nt("root node is forbidden and cannot be sanitized in-place")}}else if(b instanceof l)d=we("<!---->"),h=d.ownerDocument.importNode(b,!0),h.nodeType===Ot.element&&h.nodeName==="BODY"||h.nodeName==="HTML"?d=h:d.appendChild(h);else{if(!Et&&!gt&&!ht&&b.indexOf("<")===-1)return v&&Bt?v.createHTML(b):b;if(d=we(b),!d)return Et?null:Bt?T:""}d&&Vt&&it(d.firstChild);const z=Le(At?b:d);for(;F=z.nextNode();)ve(F),Se(F),F.content instanceof a&&eo(F.content);if(At)return b;if(Et){if(kt)for(G=C.call(d.ownerDocument);d.firstChild;)G.appendChild(d.firstChild);else G=d;return(P.shadowroot||P.shadowrootmode)&&(G=O.call(i,G,!0)),G}let J=ht?d.outerHTML:d.innerHTML;return ht&&H["!doctype"]&&d.ownerDocument&&d.ownerDocument.doctype&&d.ownerDocument.doctype.name&&V(Ge,d.ownerDocument.doctype.name)&&(J="<!DOCTYPE "+d.ownerDocument.doctype.name+`>
`+J),gt&&Yt([K,Z,dt],rt=>{J=Rt(J,rt," ")}),v&&Bt?v.createHTML(J):J},e.setConfig=function(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Jt(b),Xt=!0},e.clearConfig=function(){wt=null,Xt=!1},e.isValidAttribute=function(b,t,d){wt||Jt({});const h=W(b),F=W(t);return _e(h,F,d)},e.addHook=function(b,t){typeof t=="function"&&xt(B[b],t)},e.removeHook=function(b,t){if(t!==void 0){const d=go(B[b],t);return d===-1?void 0:Eo(B[b],d,1)[0]}return De(B[b])},e.removeHooks=function(b){B[b]=[]},e.removeAllHooks=function(){B=Fe()},e}var Wt=Xe();/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
 */const A={wasMagnifierVisible:!1,isPanning:!1,panStartX:0,panStartY:0,initialBgX:0,initialBgY:0,panHappened:!1,clickTarget:null,animationFrameId:0,targetBgX:0,targetBgY:0};function Oo(o,e,n){o&&(n.imageLightboxImage.src=o,n.imageLightboxImage.alt=e,n.imageLightbox.classList.remove("hidden"))}function Po(o){o.imageLightbox.classList.add("hidden"),o.imageLightboxImage.src=""}function ko(o,e,n,i){const{elements:s,isMobile:a}=o,{modalMagnifier:c,mapImage:l,modalMagnifierRowIndicatorContainer:g}=s,{modalMagnifierRowIndicatorPrev:y,modalMagnifierRowIndicatorCurrent:u,modalMagnifierRowIndicatorNext:f}=s;g.style.display="flex";let m=null;if(i){const r=i.id.substring(0,1);m=ct.find(p=>p.id===r)??null}else{const r=a?4.5:1.8,p=c.offsetWidth,E=c.offsetHeight,w=l.offsetWidth,L=l.offsetHeight;if(w===0||L===0)return;const I=(p/2-e)/r,N=(E/2-n)/r,v=I/w*100,T=N/L*100;let S=1/0;for(const M of ct){const C=Math.max(M.border.left-v,0,v-M.border.right),D=Math.max(M.border.top-T,0,T-M.border.bottom),O=C*C+D*D;O<S&&(S=O,m=M)}}if(m&&m.id==="範")u.textContent="",y.textContent="",f.textContent="";else if(g.style.display="flex",m){const r=ot.indexOf(m.id);u.textContent=m.id,y.textContent=r>0?ot[r-1]:"",f.textContent=r<ot.length-1?ot[r+1]:""}else u.textContent="",y.textContent="",f.textContent=""}function Ve(o,e,n,i){const{elements:s,isMobile:a,allStalls:c,uiState:l}=o,{modalMagnifier:g,modalMagnifierStallLayer:y,mapImage:u}=s,f=a?4.5:1.8,m=g.offsetWidth,r=g.offsetHeight;if(m===0||r===0)return{clampedBgX:0,clampedBgY:0};const p=u.offsetWidth,E=u.offsetHeight;if(p===0||E===0)return{clampedBgX:0,clampedBgY:0};const w=p*f,L=E*f,I=Math.max(m-w,Math.min(e,0)),N=Math.max(r-L,Math.min(n,0));g.style.backgroundPosition=`${I}px ${N}px`,y.style.transform=`translate(${I}px, ${N}px) scale(${f})`;const v=m/f*.5,T=r/f*.5,S=-I/f-v,M=-N/f-T,C=(-I+m)/f+v,D=(-N+r)/f+T;return c.forEach(O=>{const B=l.stallIdToModalCloneMap.get(O.id);if(!B||!O.numericCoords)return;const{left:K,top:Z,width:dt,height:x}=O.numericCoords,R=K/100*p,U=Z/100*E,$=R+dt/100*p,Y=U+x/100*E,Q=R<C&&$>S&&U<D&&Y>M;B.classList.toggle("modal-map-hidden",!Q)}),ct.forEach(O=>{const B=l.rowIdToModalGroupCloneMap.get(O.id);if(!B)return;const K=O.border.left/100*p,Z=O.border.top/100*E,dt=O.border.right/100*p,x=O.border.bottom/100*E,R=K<C&&dt>S&&Z<D&&x>M;B.classList.toggle("modal-map-hidden",!R)}),ko(o,I,N,i),{clampedBgX:I,clampedBgY:N}}function Bo(o,e){const{elements:n,isMobile:i}=e,{modalMagnifierWrapper:s,modalMagnifier:a,modalMagnifierStallLayer:c,mapImage:l}=n;if(!o||!o.coords){s.style.display="none";return}s.style.display="block",s.style.cursor="grab";const g=i?4.5:1.8,y=a.offsetWidth,u=a.offsetHeight;if(y===0||u===0){s.style.display="none";return}const f=l.offsetWidth,m=l.offsetHeight,r=f*g,p=m*g;c.style.width=`${f}px`,c.style.height=`${m}px`,a.style.backgroundSize=`${r}px ${p}px`,a.style.backgroundImage=`url('${l.src}')`;const{left:E,top:w,width:L,height:I}=o.numericCoords;if([E,w,L,I].some(C=>typeof C!="number")){console.error("Could not parse stall coordinates for modal magnifier:",o.coords),s.style.display="none";return}const N=(E+L/2)/100*f,v=(w+I/2)/100*m,T=y/2-N*g,S=u/2-v*g;Ve(e,T,S,o);let M=c.querySelector(".modal-stall-highlight");M||(M=document.createElement("div"),M.className="modal-stall-highlight",c.appendChild(M)),M.style.width=o.coords.width,M.style.height=o.coords.height,M.style.left=o.coords.left,M.style.top=o.coords.top,M.style.visibility="visible"}function vt(o,e){var I,N,v;const{allStalls:n,elements:i,magnifierController:s,uiState:a,isMobile:c}=e,l=n.find(T=>T.id===o);if(!l)return;s&&i.modal.classList.contains("hidden")&&(A.wasMagnifierVisible=s.isShown(),A.wasMagnifierVisible&&s.hide());const g=a.selectedStallElement,y=((I=g==null?void 0:g.dataset.stallId)==null?void 0:I.substring(0,1))??null;$e(i,s,a);const u=document.querySelector(`.stall-area[data-stall-id="${o}"]`);u&&(a.selectedStallElement=u,ce(u,"is-selected",!0,s,a)),i.modalTitle.textContent=`${l.id}: ${l.stallTitle}`;let f=l.stallImg?`<img src="${l.stallImg}" alt="Official Promo Image: ${l.stallTitle}" class="official-stall-image" loading="lazy"/>`:"";l.stallImg&&l.promoData.length>0&&(f+='<hr class="promo-section-separator">'),l.promoData.forEach((T,S)=>{S>0&&(f+='<div class="promo-entry-separator"></div>');const M=T.promoAvatar?Wt.sanitize(T.promoAvatar):"https://images.plurk.com/3rbw6tg1lA5dEGpdKTL8j1.png";let C="";T.promoTags&&T.promoTags.length>0&&(C+='<div class="promo-tags-container">',T.promoTags.forEach(B=>{const K=Wt.sanitize(B);C+=`<span class="promo-tag">#${K}</span>`}),C+="</div>");const D=Wt.sanitize(T.promoUser),O=Wt.sanitize(T.promoHTML);f+=`
      <div class="promo-entry">
          <div class="modal-user-info">
              <img src="${M}" alt="${D}" class="modal-avatar">
              <span class="modal-username">${D}</span>
          </div>
          ${C}
          <div class="promo-html-content">${O}</div>
      </div>`}),i.modalBody.innerHTML=f||"暫無宣傳資訊。",i.modalFooter.innerHTML="";const m=T=>{if(T&&T.href){const S=document.createElement("a");S.href=T.href,S.textContent=T.text,S.className="footer-link",S.target="_blank",S.rel="noopener noreferrer",i.modalFooter.appendChild(S)}};l.promoData.forEach(T=>T.promoLinks.forEach(m)),l.stallLink&&m({href:l.stallLink,text:"社團網站"});const r=ro(n,i.searchInput.value),p=l.id.substring(0,1),w=["猴","雞","狗","特","商"].includes(p);if(w){i.modalNavLeft.style.display="none",i.modalNavRight.style.display="none",i.modalNavUp.style.display="block",i.modalNavDown.style.display="block",i.modalNavUp.ariaLabel="往上一個攤位",i.modalNavDown.ariaLabel="往下一個攤位";let T,S=1;for(;l.num+S<=34;){const D=(N=r.find(O=>O.id.startsWith(p)&&O.num===l.num+S))==null?void 0:N.id;if(D){T=D;break}S+=1}let M,C=-1;for(;l.num+C>0;){const D=(v=r.find(O=>O.id.startsWith(p)&&O.num===l.num+C))==null?void 0:v.id;if(D){M=D;break}C-=1}T||(T=It(l,r,"up")),M||(M=It(l,r,"down")),i.modalNavUp.disabled=!T,i.modalNavUp.dataset.targetId=T??"",i.modalNavDown.disabled=!M,i.modalNavDown.dataset.targetId=M??"",i.modalNavLeft.disabled=!0,i.modalNavRight.disabled=!0}else{i.modalNavLeft.style.display="block",i.modalNavRight.style.display="block",i.modalNavUp.style.display="block",i.modalNavDown.style.display="block",i.modalNavUp.ariaLabel="往上一排",i.modalNavDown.ariaLabel="往下一排";const T={up:It(l,r,"up"),down:It(l,r,"down"),left:It(l,r,"left"),right:It(l,r,"right")};i.modalNavUp.disabled=!T.up,i.modalNavUp.dataset.targetId=T.up??"",i.modalNavDown.disabled=!T.down,i.modalNavDown.dataset.targetId=T.down??"",i.modalNavLeft.disabled=!T.left,i.modalNavLeft.dataset.targetId=T.left??"",i.modalNavRight.disabled=!T.right,i.modalNavRight.dataset.targetId=T.right??""}const{modalVerticalStallList:L}=i;if(w){p!==y&&(L.scrollTop=0),L.innerHTML="",L.style.display="flex";const T=n.filter(C=>C.id.startsWith(p)).sort((C,D)=>D.num-C.num),S=i.searchInput.value.toLowerCase().trim();T.forEach(C=>{const D=document.createElement("div");D.className="modal-vertical-stall-item",D.dataset.stallId=C.id,D.textContent=C.num.toString().padStart(2,"0"),C.promoData.length>0&&D.classList.add("has-promo");let O=!1;if(S!==""){const B=C.promoData.some(Z=>Z.promoUser.toLowerCase().includes(S)),K=C.promoTags.some(Z=>Z.toLowerCase().includes(S));O=C.id.toLowerCase().includes(S)||C.stallTitle.toLowerCase().includes(S)||B||K}O&&D.classList.add("is-search-match"),C.id===o&&D.classList.add("is-selected"),L.appendChild(D)});const M=L.querySelector(".is-selected");M&&requestAnimationFrame(()=>{M.scrollIntoView({behavior:"smooth",block:"center"})})}else L.innerHTML="",L.style.display="none";document.body.classList.add("body-modal-open"),i.modal.classList.remove("hidden"),i.modalNavControls.style.display="grid",i.modal.setAttribute("aria-hidden","true"),Bo(l,e)}function se(o){const{elements:e,magnifierController:n,uiState:i}=o;document.body.classList.remove("body-modal-open"),e.modal.classList.add("hidden"),e.modalNavControls.style.display="none",e.modal.setAttribute("aria-hidden","true"),$e(e,n,i),n&&A.wasMagnifierVisible&&n.show(),A.wasMagnifierVisible=!1,e.modalMagnifierWrapper.style.display="none",e.modalVerticalStallList.style.display="none"}function Ho(o,e){var l;const{allStalls:n,uiState:i}=e,s=o.closest(".stall-group-area"),a=o.closest(".stall-area:not(.stall-group-area)"),c=(l=i.selectedStallElement)==null?void 0:l.dataset.stallId;if(s!=null&&s.dataset.rowId){const g=s.dataset.rowId;if(g===(c==null?void 0:c.substring(0,1)))return;const y=n.filter(u=>u.id.startsWith(g)).sort((u,f)=>f.num-u.num);y.length>0&&vt(y[0].id,e)}else if(a!=null&&a.dataset.stallId){const g=a.dataset.stallId;if(g===c)return;vt(g,e)}}function Uo(o){const{elements:e}=o;e.modalNavControls.addEventListener("click",m=>{const r=m.target.closest(".modal-nav-btn");r!=null&&r.dataset.targetId&&vt(r.dataset.targetId,o)}),e.modalVerticalStallList.addEventListener("click",m=>{const r=m.target.closest(".modal-vertical-stall-item");r!=null&&r.dataset.stallId&&vt(r.dataset.stallId,o)});const{modalMagnifierWrapper:n,modalMagnifier:i,modalMagnifierStallLayer:s}=e,a=()=>{A.isPanning&&(Ve(o,A.targetBgX,A.targetBgY),A.animationFrameId=requestAnimationFrame(a))},c=m=>{var I;if(!A.isPanning)return;m.type==="touchmove"&&m.preventDefault();const r=(I=m.touches)==null?void 0:I[0],p=r?r.clientX:m.clientX,E=r?r.clientY:m.clientY,w=p-A.panStartX,L=E-A.panStartY;!A.panHappened&&(Math.abs(w)>5||Math.abs(L)>5)&&(A.panHappened=!0,n.style.cursor="grabbing"),A.panHappened&&(A.targetBgX=A.initialBgX+w,A.targetBgY=A.initialBgY+L)},l=()=>{cancelAnimationFrame(A.animationFrameId),document.removeEventListener("mousemove",c),document.removeEventListener("touchmove",c),document.removeEventListener("mouseup",l),document.removeEventListener("touchend",l),!A.panHappened&&A.clickTarget&&Ho(A.clickTarget,o),A.isPanning=!1,A.clickTarget=null,n.style.cursor="grab",i.style.transition="",s.style.transition=""},g=m=>{var T,S;const r=m.target;if(r.closest("#modal-vertical-stall-list"))return;const p=r.closest(".stall-group-area"),E=(T=o.uiState.selectedStallElement)==null?void 0:T.dataset.stallId;if(p&&E){const M=p.dataset.rowId,C=E.substring(0,1);if(M===C)return}if("button"in m&&m.button!==0)return;A.isPanning=!0,A.panHappened=!1,A.clickTarget=m.target;const w=(S=m.touches)==null?void 0:S[0],L=w?w.clientX:m.clientX,I=w?w.clientY:m.clientY;A.panStartX=L,A.panStartY=I;const N=new DOMMatrix(window.getComputedStyle(s).transform);A.initialBgX=N.e,A.initialBgY=N.f,A.targetBgX=A.initialBgX,A.targetBgY=A.initialBgY,i.style.transition="none",s.style.transition="none";const v=s.querySelector(".modal-stall-highlight");v&&(v.style.visibility="hidden"),cancelAnimationFrame(A.animationFrameId),A.animationFrameId=requestAnimationFrame(a),document.addEventListener("mousemove",c),document.addEventListener("touchmove",c,{passive:!1}),document.addEventListener("mouseup",l,{once:!0}),document.addEventListener("touchend",l,{once:!0})};n.addEventListener("mousedown",g),n.addEventListener("touchstart",g,{passive:!1});const y=()=>Po(e);e.modalBody.addEventListener("click",m=>{const r=m.target;if(r instanceof HTMLImageElement){let p="";const E=r.parentElement;r.classList.contains("official-stall-image")?p=r.src:r.closest(".promo-html-content")&&E instanceof HTMLAnchorElement?RegExp(/https?:\/\/.*\.(jpg|jpeg|png|gif|webp)(\?.*)?$/).test((E==null?void 0:E.href)??"")&&(p=r.alt,m.stopPropagation(),m.preventDefault()):p=r.src,Oo(p,r.alt,e)}}),e.imageLightboxClose.addEventListener("click",y),e.imageLightbox.addEventListener("click",m=>{(m.target===e.imageLightbox||m.target===e.imageLightbox.querySelector(".lightbox-overlay"))&&y()}),e.modalClose.addEventListener("click",()=>se(o)),e.modalOverlay.addEventListener("click",()=>se(o)),document.addEventListener("keydown",m=>{if(!e.imageLightbox.classList.contains("hidden")){m.key==="Escape"&&y();return}if(!e.modal.classList.contains("hidden"))switch(m.key){case"Escape":se(o);break;case"ArrowUp":e.modalNavUp.click();break;case"ArrowDown":e.modalNavDown.click();break;case"ArrowLeft":e.modalNavLeft.click();break;case"ArrowRight":e.modalNavRight.click();break}});const{modalNavControls:u,tooltip:f}=e;u.addEventListener("mouseover",m=>{const r=m.target.closest(".modal-nav-btn");if(r instanceof HTMLButtonElement&&!r.disabled){const p=r.ariaLabel;if(p){f.innerHTML=p;const E=r.getBoundingClientRect();f.classList.remove("hidden");const w=f.getBoundingClientRect(),L=E.top-w.height-8,I=E.left+E.width/2-w.width/2;f.style.left=`${I}px`,f.style.top=`${L}px`}}else f.classList.add("hidden")}),u.addEventListener("mouseleave",()=>{f.classList.add("hidden")})}/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
 */function Fo(o){const e=()=>co.every(i=>document.getElementById(i)),n=()=>{e()?o():requestAnimationFrame(n)};n()}/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
 */function $o(o){ct.forEach(e=>{const n=document.createElement("div");n.className="debug-border",n.style.top=`${e.border.top}%`,n.style.left=`${e.border.left}%`,n.style.width=`${e.border.right-e.border.left}%`,n.style.height=`${e.border.bottom-e.border.top}%`;const i=document.createElement("span");i.textContent=e.id,n.appendChild(i),o.appendChild(n)})}async function Yo(){const o=mo();new URLSearchParams(window.location.search).get("debug")==="true"&&o.mapContainer.classList.add("debug-mode"),o.instructionsEl.textContent="正在載入地圖與攤位資料",o.instructionsEl.classList.add("loading-text");const n=new Promise((i,s)=>{o.mapImage.complete?i():(o.mapImage.onload=()=>i(),o.mapImage.onerror=()=>s(new Error("Map image failed to load.")))});try{const[i]=await Promise.all([oo(),n]);if(o.instructionsEl.classList.remove("loading-text"),i.length===0){o.mapContainer.innerHTML='<p style="color: red; padding: 20px;"><b>無法載入攤位資料：</b><br>請檢查您的 Google Sheet 是否已「發佈至網路」、網址是否正確，或檢查您的網路連線。</p>',o.instructionsEl.textContent="載入失敗";return}const s=so(i),c=window.matchMedia("(max-width: 768px)").matches,l={allStalls:s,elements:o,magnifierController:null,uiState:Ct,isMobile:c},g=f=>{const m=f.closest(".stall-group-area"),r=f.closest(".stall-area:not(.stall-group-area)");if(m!=null&&m.dataset.rowId){const p=m.dataset.rowId,E=s.filter(w=>w.id.startsWith(p)).sort((w,L)=>L.num-w.num);E.length>0&&vt(E[0].id,l)}else r!=null&&r.dataset.stallId&&vt(r.dataset.stallId,l)},y=lo(o.mapContainer,o.mapImage,o.magnifierWrapper,o.magnifier,o.magnifierStallLayer,{prev:o.magnifierRowIndicatorPrev,current:o.magnifierRowIndicatorCurrent,next:o.magnifierRowIndicatorNext},o.toggleMagnifierBtn,g,c);l.magnifierController=y,fo(s,o,y,Ct),$o(o.mapContainer),Uo(l),o.searchInput.addEventListener("input",()=>{const f=o.searchInput.value.toLowerCase().trim(),m=new Set;s.forEach(r=>{const p=document.querySelector(`.stall-area[data-stall-id="${r.id}"]`);if(!p)return;let E=!1;if(f!==""){const w=r.promoData.some(I=>I.promoUser.toLowerCase().includes(f)),L=r.promoTags.some(I=>I.toLowerCase().includes(f));E=r.id.toLowerCase().includes(f)||r.stallTitle.toLowerCase().includes(f)||w||L}ce(p,"is-search-match",E,y,Ct),E&&m.add(r.id.substring(0,1))}),ct.forEach(r=>{document.querySelectorAll(`.stall-group-area[data-row-id="${r.id}"]`).forEach(E=>{const w=m.has(r.id);E.classList.toggle("is-search-match",w)})})});const u=f=>{const m=f.target;m.closest("#magnifier-wrapper")||(f.type==="touchstart"&&f.preventDefault(),g(m))};c?(o.instructionsEl.textContent="點擊按鈕可用放大鏡，或直接點擊攤位查看宣傳。",o.mapContainer.addEventListener("mousedown",u,{passive:!1}),o.mapContainer.addEventListener("touchstart",u,{passive:!1})):(o.instructionsEl.textContent="點擊按鈕顯示/隱藏放大鏡並拖曳。點擊攤位(含放大鏡內)可看宣傳。",document.addEventListener("mousemove",f=>{Ct.selectedStallElement||(o.tooltip.style.left=`${f.clientX+15}px`,o.tooltip.style.top=`${f.clientY+15}px`)}),o.mapContainer.addEventListener("mouseover",f=>{var p;const r=f.target.closest(".stall-area:not(.stall-group-area)");if(r&&!Ct.selectedStallElement){const E=r.dataset.stallId,w=s.find(L=>L.id===E);if(w){const L=(p=w.promoData)==null?void 0:p.map(I=>I.promoUser).filter((I,N,v)=>v.indexOf(I)===N).join(",");o.tooltip.innerHTML=`<strong>${w.stallTitle}</strong><br><small>${w.id}${L?` / ${L}`:""}</small>`,o.tooltip.classList.remove("hidden")}}}),o.mapContainer.addEventListener("mouseout",f=>{f.target.classList.contains("stall-area")&&o.tooltip.classList.add("hidden")}),o.mapContainer.addEventListener("mousedown",u))}catch(i){console.error("Failed to initialize app:",i),o.instructionsEl.classList.remove("loading-text"),o.instructionsEl.textContent="地圖或資料載入失敗，請重新整理頁面。"}}Fo(Yo);
